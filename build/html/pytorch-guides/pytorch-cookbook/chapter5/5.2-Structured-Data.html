<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.35. 5.2 Pytorch处理结构化数据 &mdash; AI 模型国内加速  文档</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/style.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="author" title="关于这些文档" href="../../../about.html" />
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" />
    <link rel="next" title="3.1.36. Fashion MNIST进行分类" href="5.3-Fashion-MNIST.html" />
    <link rel="prev" title="3.1.34. 5.1 kaggle介绍" href="5.1-kaggle.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            AI 模型国内加速
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">目录:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../best-practice/index.html">1. 【AI网盘】人工智能资源汇总</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stable-diffusion/index.html">2. Stable Diffusion</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">3. Pytorch 教程</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">3.1. Pytorch 快速入门</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1.1-pytorch-introduction.html">3.1.1. 1.1 Pytorch 简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1.2-pytorch-installation.html">3.1.2. 1.2 Pytorch环境搭建</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1.2-pytorch-installation.html#id1">3.1.3. 1.2.1 安装Pytorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1.3-deep-learning-with-pytorch-60-minute-blitz.html">3.1.4. PyTorch 深度学习:60分钟快速入门 （官方）</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1.4-pytorch-resource.html">3.1.5. 相关资源列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/1_tensor_tutorial.html">3.1.6. PyTorch是什么?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/2_autograd_tutorial.html">3.1.7. Autograd: 自动求导机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/3_neural_networks_tutorial.html">3.1.8. Neural Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/4_cifar10_tutorial.html">3.1.9. 训练一个分类器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/5_data_parallel_tutorial.html">3.1.10. 数据并行（选读）</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter1/readme.html">3.1.11. PyTorch 中文手册第一章 ： PyTorch入门</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.1.1.pytorch-basics-tensor.html">3.1.12. PyTorch 基础 : 张量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.1.2-pytorch-basics-autograd.html">3.1.13. 使用PyTorch计算梯度数值</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.1.3-pytorch-basics-nerual-network.html">3.1.14. PyTorch 基础 : 神经网络包nn和优化器optm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.1.4-pytorch-basics-data-loader.html">3.1.15. PyTorch 基础 :数据的加载和预处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.2-deep-learning-basic-mathematics.html">3.1.16. 2.2 深度学习基础及数学原理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.3-deep-learning-neural-network-introduction.html">3.1.17. 2.3 神经网络简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.4-cnn.html">3.1.18. 2.4 卷积神经网络简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/2.5-rnn.html">3.1.19. 2.5 循环神经网络</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter2/readme.html">3.1.20. Pytorch 中文手册第二章 ： 基础</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter3/3.1-logistic-regression.html">3.1.21. 3.1 logistic回归实战</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter3/3.2-mnist.html">3.1.22. 3.2  MNIST数据集手写数字识别</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter3/3.3-rnn.html">3.1.23. 3.3 通过Sin预测Cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter3/readme.html">3.1.24. Pytorch 中文手册第三章 ： 实践</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.1-fine-tuning.html">3.1.25. 4.1 Fine tuning 模型微调</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.2.1-visdom.html">3.1.26. 4.2.1 使用Visdom在 PyTorch 中进行可视化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.2.2-tensorboardx.html">3.1.27. 4.2.2 使用Tensorboard在 PyTorch 中进行可视化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.2.3-cnn-visualizing.html">3.1.28. 4.2.3 可视化理解卷积神经网络</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.2.3-cnn-visualizing.html#backpropagation">3.1.29. 基于Backpropagation的方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.3-fastai.html">3.1.30. 4.3 fastai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/4.5-multiply-gpu-parallel-training.html">3.1.31. 4.5 多GPU并行训练</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/distributed_data_parallel.html">3.1.32. 在PyTorch中使用DistributedDataParallel进行多GPU分布式模型训练</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chapter4/readme.html">3.1.33. Pytorch 中文手册第四章 ： 提高</a></li>
<li class="toctree-l3"><a class="reference internal" href="5.1-kaggle.html">3.1.34. 5.1 kaggle介绍</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.1.35. 5.2 Pytorch处理结构化数据</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">3.1.35.1. 简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">3.1.35.2. 数据预处理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">3.1.35.3. 定义数据集</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">3.1.35.4. 定义模型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">3.1.35.5. 训练</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="5.3-Fashion-MNIST.html">3.1.36. Fashion MNIST进行分类</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html">3.1.37. Pytorch 中文手册第五章 ： 应用</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../style-guides/index.html">4. 编程语言 风格指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../coding/index.html">5. 编程语言 语法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cheatsheet/index.html">6. Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">7. 关于</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AI 模型国内加速</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><span class="section-number">3. </span>Pytorch 教程</a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">3.1. </span>Pytorch 快速入门</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.1.35. </span>5.2 Pytorch处理结构化数据</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/pytorch-guides/pytorch-cookbook/chapter5/5.2-Structured-Data.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">torch</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;1.4.0&#39;</span>
</pre></div>
</div>
<section id="pytorch">
<h1><span class="section-number">3.1.35. </span>5.2 Pytorch处理结构化数据<a class="headerlink" href="#pytorch" title="Permalink to this heading"></a></h1>
<section id="id1">
<h2><span class="section-number">3.1.35.1. </span>简介<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<p>在介绍之前，我们首先要明确下什么是结构化的数据。结构化数据，可以从名称中看出，是高度组织和整齐格式化的数据。它是可以放入表格和电子表格中的数据类型。对我们来说，结构化数据可以理解为就是一张2维的表格，例如一个csv文件，就是结构化数据，在英文一般被称作Tabular Data或者叫 structured data，下面我们来看一下结构化数据的例子。</p>
<p>一下文件来自于fastai的自带数据集：
https://github.com/fastai/fastai/blob/master/examples/tabular.ipynb
fastai样例在这里</p>
</section>
<section id="id2">
<h2><span class="section-number">3.1.35.2. </span>数据预处理<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h2>
<p>我们拿到的结构化数据，一般都是一个csv文件或者数据库中的一张表格，所以对于结构化的数据，我们直接使用pasdas库处理就可以了</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#读入文件</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/adult.csv&#39;</span><span class="p">)</span>
<span class="c1">#salary是这个数据集最后要分类的结果</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;&gt;=50k&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;50k&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看数据类型</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">dataframe</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">top</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">dataframe</span> <span class="n">thead</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>NaN</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Private</td>
      <td>236746</td>
      <td>Masters</td>
      <td>14.0</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>96185</td>
      <td>HS-grad</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>NaN</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>Self-emp-inc</td>
      <td>112847</td>
      <td>Prof-school</td>
      <td>15.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Self-emp-not-inc</td>
      <td>82297</td>
      <td>7th-8th</td>
      <td>NaN</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#pandas的describe可以告诉我们整个数据集的大概结构，是非常有用的</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">dataframe</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">top</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">dataframe</span> <span class="n">thead</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>32561.000000</td>
      <td>3.256100e+04</td>
      <td>32074.000000</td>
      <td>32561.000000</td>
      <td>32561.000000</td>
      <td>32561.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>38.581647</td>
      <td>1.897784e+05</td>
      <td>10.079815</td>
      <td>1077.648844</td>
      <td>87.303830</td>
      <td>40.437456</td>
    </tr>
    <tr>
      <th>std</th>
      <td>13.640433</td>
      <td>1.055500e+05</td>
      <td>2.572999</td>
      <td>7385.292085</td>
      <td>402.960219</td>
      <td>12.347429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>17.000000</td>
      <td>1.228500e+04</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>28.000000</td>
      <td>1.178270e+05</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>37.000000</td>
      <td>1.783560e+05</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>48.000000</td>
      <td>2.370510e+05</td>
      <td>12.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>90.000000</td>
      <td>1.484705e+06</td>
      <td>16.000000</td>
      <td>99999.000000</td>
      <td>4356.000000</td>
      <td>99.000000</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看一共有多少数据</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">32561</span>
</pre></div>
</div>
<p>对于模型的训练，只能够处理数字类型的数据，所以这里面我们首先要将数据分成三个类别</p>
<ul class="simple">
<li><p>训练的结果标签：即训练的结果，通过这个结果我们就能够明确的知道我们这次训练的任务是什么，是分类的任务，还是回归的任务。</p></li>
<li><p>分类数据：这类的数据是离散的，无法通过直接输入到模型中进行训练，所以我们在预处理的时候需要优先对这部分进行处理，这也是数据预处理的主要工作之一</p></li>
<li><p>数值型数据：这类数据是直接可以输入到模型中的，但是这部分数据有可能还是离散的，所以如果需要也可以对其进行处理，并且处理后会对训练的精度有很大的提升，这里暂且不讨论</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#训练结果</span>
<span class="n">result_var</span> <span class="o">=</span> <span class="s1">&#39;salary&#39;</span>
<span class="c1">#分类型数据</span>
<span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span><span class="s1">&#39;native-country&#39;</span><span class="p">]</span>
<span class="c1">#数值型数据</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">,</span><span class="s1">&#39;capital-gain&#39;</span><span class="p">,</span><span class="s1">&#39;capital-loss&#39;</span><span class="p">,</span><span class="s1">&#39;hours-per-week&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>人工确认完数据类型后，我们可以看一下分类类型数据的数量和分布情况</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_names</span><span class="p">:</span>
        <span class="n">ccol</span><span class="o">=</span><span class="n">Counter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ccol</span><span class="p">),</span><span class="n">ccol</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workclass</span> <span class="mi">9</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; Private&#39;</span><span class="p">:</span> <span class="mi">22696</span><span class="p">,</span> <span class="s1">&#39; Self-emp-not-inc&#39;</span><span class="p">:</span> <span class="mi">2541</span><span class="p">,</span> <span class="s1">&#39; Local-gov&#39;</span><span class="p">:</span> <span class="mi">2093</span><span class="p">,</span> <span class="s1">&#39; ?&#39;</span><span class="p">:</span> <span class="mi">1836</span><span class="p">,</span> <span class="s1">&#39; State-gov&#39;</span><span class="p">:</span> <span class="mi">1298</span><span class="p">,</span> <span class="s1">&#39; Self-emp-inc&#39;</span><span class="p">:</span> <span class="mi">1116</span><span class="p">,</span> <span class="s1">&#39; Federal-gov&#39;</span><span class="p">:</span> <span class="mi">960</span><span class="p">,</span> <span class="s1">&#39; Without-pay&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; Never-worked&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>


<span class="n">education</span> <span class="mi">16</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; HS-grad&#39;</span><span class="p">:</span> <span class="mi">10501</span><span class="p">,</span> <span class="s1">&#39; Some-college&#39;</span><span class="p">:</span> <span class="mi">7291</span><span class="p">,</span> <span class="s1">&#39; Bachelors&#39;</span><span class="p">:</span> <span class="mi">5355</span><span class="p">,</span> <span class="s1">&#39; Masters&#39;</span><span class="p">:</span> <span class="mi">1723</span><span class="p">,</span> <span class="s1">&#39; Assoc-voc&#39;</span><span class="p">:</span> <span class="mi">1382</span><span class="p">,</span> <span class="s1">&#39; 11th&#39;</span><span class="p">:</span> <span class="mi">1175</span><span class="p">,</span> <span class="s1">&#39; Assoc-acdm&#39;</span><span class="p">:</span> <span class="mi">1067</span><span class="p">,</span> <span class="s1">&#39; 10th&#39;</span><span class="p">:</span> <span class="mi">933</span><span class="p">,</span> <span class="s1">&#39; 7th-8th&#39;</span><span class="p">:</span> <span class="mi">646</span><span class="p">,</span> <span class="s1">&#39; Prof-school&#39;</span><span class="p">:</span> <span class="mi">576</span><span class="p">,</span> <span class="s1">&#39; 9th&#39;</span><span class="p">:</span> <span class="mi">514</span><span class="p">,</span> <span class="s1">&#39; 12th&#39;</span><span class="p">:</span> <span class="mi">433</span><span class="p">,</span> <span class="s1">&#39; Doctorate&#39;</span><span class="p">:</span> <span class="mi">413</span><span class="p">,</span> <span class="s1">&#39; 5th-6th&#39;</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span> <span class="s1">&#39; 1st-4th&#39;</span><span class="p">:</span> <span class="mi">168</span><span class="p">,</span> <span class="s1">&#39; Preschool&#39;</span><span class="p">:</span> <span class="mi">51</span><span class="p">})</span>


<span class="n">marital</span><span class="o">-</span><span class="n">status</span> <span class="mi">7</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; Married-civ-spouse&#39;</span><span class="p">:</span> <span class="mi">14976</span><span class="p">,</span> <span class="s1">&#39; Never-married&#39;</span><span class="p">:</span> <span class="mi">10683</span><span class="p">,</span> <span class="s1">&#39; Divorced&#39;</span><span class="p">:</span> <span class="mi">4443</span><span class="p">,</span> <span class="s1">&#39; Separated&#39;</span><span class="p">:</span> <span class="mi">1025</span><span class="p">,</span> <span class="s1">&#39; Widowed&#39;</span><span class="p">:</span> <span class="mi">993</span><span class="p">,</span> <span class="s1">&#39; Married-spouse-absent&#39;</span><span class="p">:</span> <span class="mi">418</span><span class="p">,</span> <span class="s1">&#39; Married-AF-spouse&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">})</span>


<span class="n">occupation</span> <span class="mi">16</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; Prof-specialty&#39;</span><span class="p">:</span> <span class="mi">4073</span><span class="p">,</span> <span class="s1">&#39; Craft-repair&#39;</span><span class="p">:</span> <span class="mi">4028</span><span class="p">,</span> <span class="s1">&#39; Exec-managerial&#39;</span><span class="p">:</span> <span class="mi">4009</span><span class="p">,</span> <span class="s1">&#39; Adm-clerical&#39;</span><span class="p">:</span> <span class="mi">3720</span><span class="p">,</span> <span class="s1">&#39; Sales&#39;</span><span class="p">:</span> <span class="mi">3590</span><span class="p">,</span> <span class="s1">&#39; Other-service&#39;</span><span class="p">:</span> <span class="mi">3247</span><span class="p">,</span> <span class="s1">&#39; Machine-op-inspct&#39;</span><span class="p">:</span> <span class="mi">1968</span><span class="p">,</span> <span class="s1">&#39; ?&#39;</span><span class="p">:</span> <span class="mi">1820</span><span class="p">,</span> <span class="s1">&#39; Transport-moving&#39;</span><span class="p">:</span> <span class="mi">1566</span><span class="p">,</span> <span class="s1">&#39; Handlers-cleaners&#39;</span><span class="p">:</span> <span class="mi">1347</span><span class="p">,</span> <span class="s1">&#39; Farming-fishing&#39;</span><span class="p">:</span> <span class="mi">977</span><span class="p">,</span> <span class="s1">&#39; Tech-support&#39;</span><span class="p">:</span> <span class="mi">905</span><span class="p">,</span> <span class="s1">&#39; Protective-serv&#39;</span><span class="p">:</span> <span class="mi">643</span><span class="p">,</span> <span class="n">nan</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s1">&#39; Priv-house-serv&#39;</span><span class="p">:</span> <span class="mi">147</span><span class="p">,</span> <span class="s1">&#39; Armed-Forces&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>


<span class="n">relationship</span> <span class="mi">6</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; Husband&#39;</span><span class="p">:</span> <span class="mi">13193</span><span class="p">,</span> <span class="s1">&#39; Not-in-family&#39;</span><span class="p">:</span> <span class="mi">8305</span><span class="p">,</span> <span class="s1">&#39; Own-child&#39;</span><span class="p">:</span> <span class="mi">5068</span><span class="p">,</span> <span class="s1">&#39; Unmarried&#39;</span><span class="p">:</span> <span class="mi">3446</span><span class="p">,</span> <span class="s1">&#39; Wife&#39;</span><span class="p">:</span> <span class="mi">1568</span><span class="p">,</span> <span class="s1">&#39; Other-relative&#39;</span><span class="p">:</span> <span class="mi">981</span><span class="p">})</span>


<span class="n">race</span> <span class="mi">5</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; White&#39;</span><span class="p">:</span> <span class="mi">27816</span><span class="p">,</span> <span class="s1">&#39; Black&#39;</span><span class="p">:</span> <span class="mi">3124</span><span class="p">,</span> <span class="s1">&#39; Asian-Pac-Islander&#39;</span><span class="p">:</span> <span class="mi">1039</span><span class="p">,</span> <span class="s1">&#39; Amer-Indian-Eskimo&#39;</span><span class="p">:</span> <span class="mi">311</span><span class="p">,</span> <span class="s1">&#39; Other&#39;</span><span class="p">:</span> <span class="mi">271</span><span class="p">})</span>


<span class="n">sex</span> <span class="mi">2</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; Male&#39;</span><span class="p">:</span> <span class="mi">21790</span><span class="p">,</span> <span class="s1">&#39; Female&#39;</span><span class="p">:</span> <span class="mi">10771</span><span class="p">})</span>


<span class="n">native</span><span class="o">-</span><span class="n">country</span> <span class="mi">42</span> <span class="n">Counter</span><span class="p">({</span><span class="s1">&#39; United-States&#39;</span><span class="p">:</span> <span class="mi">29170</span><span class="p">,</span> <span class="s1">&#39; Mexico&#39;</span><span class="p">:</span> <span class="mi">643</span><span class="p">,</span> <span class="s1">&#39; ?&#39;</span><span class="p">:</span> <span class="mi">583</span><span class="p">,</span> <span class="s1">&#39; Philippines&#39;</span><span class="p">:</span> <span class="mi">198</span><span class="p">,</span> <span class="s1">&#39; Germany&#39;</span><span class="p">:</span> <span class="mi">137</span><span class="p">,</span> <span class="s1">&#39; Canada&#39;</span><span class="p">:</span> <span class="mi">121</span><span class="p">,</span> <span class="s1">&#39; Puerto-Rico&#39;</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span> <span class="s1">&#39; El-Salvador&#39;</span><span class="p">:</span> <span class="mi">106</span><span class="p">,</span> <span class="s1">&#39; India&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39; Cuba&#39;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span> <span class="s1">&#39; England&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39; Jamaica&#39;</span><span class="p">:</span> <span class="mi">81</span><span class="p">,</span> <span class="s1">&#39; South&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39; China&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span> <span class="s1">&#39; Italy&#39;</span><span class="p">:</span> <span class="mi">73</span><span class="p">,</span> <span class="s1">&#39; Dominican-Republic&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="s1">&#39; Vietnam&#39;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span> <span class="s1">&#39; Guatemala&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39; Japan&#39;</span><span class="p">:</span> <span class="mi">62</span><span class="p">,</span> <span class="s1">&#39; Poland&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39; Columbia&#39;</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span> <span class="s1">&#39; Taiwan&#39;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span> <span class="s1">&#39; Haiti&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="s1">&#39; Iran&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39; Portugal&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span> <span class="s1">&#39; Nicaragua&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="s1">&#39; Peru&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="s1">&#39; Greece&#39;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39; France&#39;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39; Ecuador&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39; Ireland&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39; Hong&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39; Trinadad&amp;Tobago&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39; Cambodia&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39; Thailand&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39; Laos&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39; Yugoslavia&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39; Outlying-US(Guam-USVI-etc)&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; Hungary&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; Honduras&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; Scotland&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; Holand-Netherlands&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>下一步就是要将分类型数据转成数字型数据，在这部分里面，我们还做了对于缺失数据的填充</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_names</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cont_names</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>上面的代码中：</p>
<p>我们首先使用了pandas的fillna函数对分类的数据做了空值的填充，这里面标识成一个与其他现有值不一样的值就可以，这里面我使用的三个中划线 — 作为标记，然后就是使用了sklearn的LabelEncoder函数进行了数据的处理</p>
<p>然后有对我们的数值型的数据做了0填充的处理，对于数值型数据的填充，也可以使用平均值，或者其他方式填充，这个不是我们的重点，就不详细说明了。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">dataframe</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">top</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">dataframe</span> <span class="n">thead</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>4</td>
      <td>101320</td>
      <td>7</td>
      <td>12.0</td>
      <td>2</td>
      <td>15</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>39</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>4</td>
      <td>236746</td>
      <td>12</td>
      <td>14.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>39</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>4</td>
      <td>96185</td>
      <td>11</td>
      <td>0.0</td>
      <td>0</td>
      <td>15</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>39</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>5</td>
      <td>112847</td>
      <td>14</td>
      <td>15.0</td>
      <td>2</td>
      <td>10</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>6</td>
      <td>82297</td>
      <td>5</td>
      <td>0.0</td>
      <td>2</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>39</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div><p>数据处理完成后可以看到，现在所有的数据都是数字类型的了，可以直接输入到模型进行训练了.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#分割下训练数据和标签</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span>
<span class="n">Y_label</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">Y</span><span class="o">=</span><span class="n">Y_label</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">Y</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">result_var</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">dataframe</span> <span class="n">tbody</span> <span class="n">tr</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">top</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">dataframe</span> <span class="n">thead</span> <span class="n">th</span> <span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>4</td>
      <td>101320</td>
      <td>7</td>
      <td>12.0</td>
      <td>2</td>
      <td>15</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>39</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>4</td>
      <td>236746</td>
      <td>12</td>
      <td>14.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>39</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>4</td>
      <td>96185</td>
      <td>11</td>
      <td>0.0</td>
      <td>0</td>
      <td>15</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>39</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>5</td>
      <td>112847</td>
      <td>14</td>
      <td>15.0</td>
      <td>2</td>
      <td>10</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>6</td>
      <td>82297</td>
      <td>5</td>
      <td>0.0</td>
      <td>2</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>39</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32556</th>
      <td>36</td>
      <td>4</td>
      <td>297449</td>
      <td>9</td>
      <td>13.0</td>
      <td>0</td>
      <td>10</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>14084</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
    </tr>
    <tr>
      <th>32557</th>
      <td>23</td>
      <td>0</td>
      <td>123983</td>
      <td>9</td>
      <td>13.0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
    </tr>
    <tr>
      <th>32558</th>
      <td>53</td>
      <td>4</td>
      <td>157069</td>
      <td>7</td>
      <td>12.0</td>
      <td>2</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
    </tr>
    <tr>
      <th>32559</th>
      <td>32</td>
      <td>2</td>
      <td>217296</td>
      <td>11</td>
      <td>9.0</td>
      <td>2</td>
      <td>14</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>4064</td>
      <td>0</td>
      <td>22</td>
      <td>39</td>
    </tr>
    <tr>
      <th>32560</th>
      <td>26</td>
      <td>4</td>
      <td>182308</td>
      <td>15</td>
      <td>10.0</td>
      <td>2</td>
      <td>10</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>39</td>
    </tr>
  </tbody>
</table>
<p>32561 rows × 14 columns</p>
</div><p>以上，基本的数据预处理已经完成了，上面展示的只是一些必要的处理，如果要提高训练准确率还有很多技巧，这里就不详细说明了。</p>
</section>
<section id="id3">
<h2><span class="section-number">3.1.35.3. </span>定义数据集<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h2>
<p>要使用pytorch处理数据，肯定要使用Dataset进行数据集的定义，下面定义一个简单的数据集</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">tabularDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Y</span>
        
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">tabularDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p>可以直接使用索引访问定义好的数据集中的数据</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">4.9000e+01</span><span class="p">,</span> <span class="mf">4.0000e+00</span><span class="p">,</span> <span class="mf">1.0132e+05</span><span class="p">,</span> <span class="mf">7.0000e+00</span><span class="p">,</span> <span class="mf">1.2000e+01</span><span class="p">,</span>
        <span class="mf">2.0000e+00</span><span class="p">,</span> <span class="mf">1.5000e+01</span><span class="p">,</span> <span class="mf">5.0000e+00</span><span class="p">,</span> <span class="mf">4.0000e+00</span><span class="p">,</span> <span class="mf">0.0000e+00</span><span class="p">,</span>
        <span class="mf">0.0000e+00</span><span class="p">,</span> <span class="mf">1.9020e+03</span><span class="p">,</span> <span class="mf">4.0000e+01</span><span class="p">,</span> <span class="mf">3.9000e+01</span><span class="p">]),</span>
 <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h2><span class="section-number">3.1.35.4. </span>定义模型<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h2>
<p>数据已经准备完毕了，下一步就是要定义我们的模型了，这里使用了3层线性层的简单模型作为处理</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">tabularModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn_in</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_in</span><span class="p">):</span>
        <span class="c1">#print(x_in.shape)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn_in</span><span class="p">(</span><span class="n">x_in</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lin1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#print(x)</span>
        
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lin2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#print(x)</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>在定义模型的时候看到了我们加入了Batch Normalization来做批量的归一化：
批量归一化的内容请见这篇文章：https://mp.weixin.qq.com/s/FFLQBocTZGqnyN79JbSYcQ</p>
<p>或者扫描这个二维码，在微信中查看:
<img alt="https://raw.githubusercontent.com/zergtant/pytorch-handbook/master/deephub.jpg" src="https://raw.githubusercontent.com/zergtant/pytorch-handbook/master/deephub.jpg" /></p>
</section>
<section id="id5">
<h2><span class="section-number">3.1.35.5. </span>训练<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#训练前指定使用的设备</span>
<span class="n">DEVICE</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">DEVICE</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cuda</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#损失函数</span>
<span class="n">criterion</span> <span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#实例化模型</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tabularModel</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabularModel</span><span class="p">(</span>
  <span class="p">(</span><span class="n">lin1</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">lin2</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">lin3</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">bn_in</span><span class="p">):</span> <span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">bn1</span><span class="p">):</span> <span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">bn2</span><span class="p">):</span> <span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#测试模型是否没问题</span>
<span class="n">rn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">model</span><span class="p">(</span><span class="n">rn</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.5110</span><span class="p">,</span> <span class="mf">0.1931</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.4274</span><span class="p">,</span> <span class="mf">0.5801</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.5549</span><span class="p">,</span> <span class="mf">0.7322</span><span class="p">]],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">,</span> <span class="n">grad_fn</span><span class="o">=&lt;</span><span class="n">SigmoidBackward</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#学习率</span>
<span class="n">LEARNING_RATE</span><span class="o">=</span><span class="mf">0.01</span>
<span class="c1">#BS</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="c1">#优化器</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">LEARNING_RATE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#DataLoader加载数据</span>
<span class="n">train_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>以上的基本步骤是每个训练过程都需要的，所以就不多介绍了，下面开始进行模型的训练</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="c1">#训练10轮</span>
<span class="n">TOTAL_EPOCHS</span><span class="o">=</span><span class="mi">100</span>
<span class="c1">#记录损失函数</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TOTAL_EPOCHS</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dl</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="c1">#输入必须未float类型</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">long</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="c1">#结果标签必须未long类型</span>
        <span class="c1">#清零</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#计算损失函数</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Epoch : </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">,   Loss: </span><span class="si">%.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">TOTAL_EPOCHS</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">losses</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Epoch</span> <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4936</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4766</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">3</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4693</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4653</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">5</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4627</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">6</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4606</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">7</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4591</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">8</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4582</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">9</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4573</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">10</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4565</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">11</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4557</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">12</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4551</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">13</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4546</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">14</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4540</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">15</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4535</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">16</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4530</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">17</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4526</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">18</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4522</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">19</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4519</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">20</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4515</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">21</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4511</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">22</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4508</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">23</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4504</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">24</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4502</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">25</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4499</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">26</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4496</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">27</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4492</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">28</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4489</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">29</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4486</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">30</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4483</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">31</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4480</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">32</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4477</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">33</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4474</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">34</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4471</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">35</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4469</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">36</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4466</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">37</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4463</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">38</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4460</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">39</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4458</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">40</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4455</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">41</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4452</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">42</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4449</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">43</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4447</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">44</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4445</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">45</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4442</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">46</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4439</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">47</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4437</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">48</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4434</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">49</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4432</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">50</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4429</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">51</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4426</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">52</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4424</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">53</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4421</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">54</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4419</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">55</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4417</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">56</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4414</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">57</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4411</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">58</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4409</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">59</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4406</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">60</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4404</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">61</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4402</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">62</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4399</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">63</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4397</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">64</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4394</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">65</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4392</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">66</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4390</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">67</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4387</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">68</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4384</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">69</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4382</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">70</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4380</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">71</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4377</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">72</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4375</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">73</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4373</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">74</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4371</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">75</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4368</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">76</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4366</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">77</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4364</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">78</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4362</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">79</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4360</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">80</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4358</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">81</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4356</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">82</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4353</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">83</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4351</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">84</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4348</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">85</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4346</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">86</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4344</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">87</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4342</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">88</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4340</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">89</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4338</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">90</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4336</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">91</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4333</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">92</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4331</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">93</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4329</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">94</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4328</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">95</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4326</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">96</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4324</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">97</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4322</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">98</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4320</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">99</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4318</span>
<span class="n">Epoch</span> <span class="p">:</span> <span class="mi">100</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>   <span class="n">Loss</span><span class="p">:</span> <span class="mf">0.4316</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">49.6</span> <span class="n">s</span>
</pre></div>
</div>
<p>训练完成后我们可以看一下模型的准确率</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dl</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">+=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;准确率: </span><span class="si">%.4f</span><span class="s1"> </span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">准确率</span><span class="p">:</span> <span class="mf">89.0000</span> <span class="o">%</span>
</pre></div>
</div>
<p>以上就是基本的流程了</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="5.1-kaggle.html" class="btn btn-neutral float-left" title="3.1.34. 5.1 kaggle介绍" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="5.3-Fashion-MNIST.html" class="btn btn-neutral float-right" title="3.1.36. Fashion MNIST进行分类" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
  
<div class="view_counter">
      <img class="img_view_counter" src="https://s01.flagcounter.com/count2/m02K/bg_FFFFFF/txt_F77B1B/border_CCCCCC/columns_3/maxflags_6/viewers_3/labels_1/pageviews_0/flags_0/percent_0/" alt="View Counter" border="0" />
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="版本">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Read the Docs</span>
        v: latest
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>版本</dt>
            <dd><a href="#">latest</a></dd>
        </dl>
    </div>
</div>

</body>
</html>